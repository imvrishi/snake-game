!function(t){"use strict";class e{constructor(){this.frameRate=10,this.tileSize=30,this.fontMinLimit=10,this.fontMaxLimit=20,this.blockSize=this.tileSize-2,this.canvasWidth=window.innerWidth-window.innerWidth%this.tileSize,this.canvasHeight=window.innerHeight-window.innerHeight%this.tileSize,this.tileCountX=Math.floor(this.canvasWidth/this.tileSize),this.tileCountY=Math.floor(this.canvasHeight/this.tileSize)}static instance(){return null==this._instance&&(this._instance=new e),this._instance}}e._instance=null;const i=e.instance(),{tileSize:s,blockSize:h,tileCountX:a,tileCountY:n}=i;class r{constructor(t){this._x=0,this._y=0,this.game=t,this.spawn()}get x(){return this._x}get y(){return this._y}draw(){const{ctx:t}=this.game;t.fillStyle="red",t.fillRect(this._x*s,this._y*s,h,h)}spawn(){this._x=this.random(0,a),this._y=this.random(0,n);for(const t of this.game.snake.parts)if(t.x===this._x&&t.y===this._y){this.spawn();break}}random(t,e){return Math.floor(Math.random()*(e-t)+t)}}class c{constructor(t=0,e=0){this.x=t,this.y=e}}const{tileSize:o,blockSize:l,tileCountX:d,tileCountY:y,canvasWidth:m,canvasHeight:f}=i;class w{constructor(t){this.headX=0,this.headY=0,this._velocityX=0,this._velocityY=0,this.tailLength=0,this.parts=[],this.headX=Math.floor(d/2),this.headY=Math.floor(y/2),this.game=t}get velocityX(){return this._velocityX}get velocityY(){return this._velocityY}draw(){const{ctx:t}=this.game;for(;this.parts.length>this.tailLength;)this.parts.pop();this.parts.unshift(new c(this.headX,this.headY));for(const e of this.parts)t.fillStyle="green",t.fillRect(e.x*o,e.y*o,l,l);t.fillStyle="orange",t.fillRect(this.headX*o,this.headY*o,l,l)}dir(t,e){this._velocityX=t,this._velocityY=e}move(){this.headX=this.headX+this._velocityX,this.headY=this.headY+this._velocityY}eat(){const{apple:t}=this.game;t.x===this.headX&&t.y===this.headY&&(t.spawn(),this.game.score++,this.tailLength++,this.game.score&&this.game.score%5==0&&(i.frameRate+=5))}isGameOver(){let t=!1;if(0===this._velocityX&&0===this._velocityY)return!1;(this.headX<0||this.headX===d||this.headY<0||this.headY===y)&&(t=!0);for(const e of this.parts)if(e.x===this.headX&&e.y===this.headY){t=!0;break}if(t){const{ctx:t}=this.game,e="Game Over!";t.fillStyle="white";const i=m/10;t.font=i+"pt Verdana";const s=t.measureText(e).width;t.fillText(e,m/2-s/2,f/2)}return t}}const{canvasWidth:v,canvasHeight:u,fontMaxLimit:g,fontMinLimit:x}=i;class p{constructor(){this.lastRenderTime=0,this.isGameOver=!1,this.score=0,this.handleKeyPress=this.handleKeyPress.bind(this),this.draw=this.draw.bind(this),this.canvas=document.getElementById("board"),this.canvas.width=v,this.canvas.height=u,this.canvas.parentElement?this.canvas.parentElement.addEventListener("keydown",this.handleKeyPress):console.log("Probably the html structure has changed"),this.ctx=this.canvas.getContext("2d"),this.snake=new w(this),this.apple=new r(this),window.requestAnimationFrame(this.draw)}draw(t){const e=(t-this.lastRenderTime)/1e3;window.requestAnimationFrame(this.draw),e<1/i.frameRate||(this.lastRenderTime=t,this.snake.move(),this.isGameOver||(this.isGameOver=this.snake.isGameOver()),this.isGameOver||(this.clear(),this.snake.eat(),this.apple.draw(),this.snake.draw(),this.drawScore()))}clear(){this.ctx.fillStyle="black",this.ctx.fillRect(0,0,v,u)}drawScore(){const t=`Score: ${this.score} - Speed: ${i.frameRate}`;this.ctx.fillStyle="white";let e=v/40;e=Math.min(g,e),e=Math.max(x,e),this.ctx.font=e+"pt Verdana";const s=this.ctx.measureText(t).width;this.ctx.fillText(t,v-s,e)}handleKeyPress(t){switch(t.code){case"KeyW":case"KeyI":case"ArrowUp":if(1===this.snake.velocityY)return;this.snake.dir(0,-1);break;case"KeyS":case"KeyK":case"ArrowDown":if(-1===this.snake.velocityY)return;this.snake.dir(0,1);break;case"KeyA":case"KeyJ":case"ArrowLeft":if(1===this.snake.velocityX)return;this.snake.dir(-1,0);break;case"KeyL":case"KeyD":case"ArrowRight":if(-1===this.snake.velocityX)return;this.snake.dir(1,0)}}}new p,t.Game=p,Object.defineProperty(t,"__esModule",{value:!0})}({});
